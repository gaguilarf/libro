<div class="patient-detail-container">
  
  <!-- Header -->
  <div class="header d-flex align-items-center justify-content-between">
    <div class="d-flex align-items-center">
      <button class="btn btn-link text-primary p-0 me-3" (click)="goBack()">
        <i class="bi bi-arrow-left me-1"></i>
        Regresar
      </button>
    </div>
    
    <div class="user-info d-flex align-items-center">
      <img src="assets/ic_usuario.png" alt="Usuario" class="user-avatar me-2">
      <div>
        <div class="fw-bold">Dr. Marcelo</div>
        <div class="text-muted small">marcelo.com</div>
      </div>
    </div>
  </div>

  <!-- Loading -->
  <div *ngIf="isLoading" class="text-center my-5">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Cargando...</span>
    </div>
    <p class="mt-2">Cargando informaci贸n del paciente...</p>
  </div>

  <!-- Error -->
  <div *ngIf="error" class="alert alert-danger">
    <i class="bi bi-exclamation-triangle me-2"></i>
    {{ error }}
  </div>


  <div class="row position-relative">

    <button 
      class="toggle-sidebar-btn btn btn-light shadow"
      (click)="toggleSidebar()"
      [ngStyle]="{
        left: showSidebar ? '617px' : '2px'
      }"
      title="Mostrar/Ocultar 铆ndice"
    >
      <i class="bi" [ngClass]="showSidebar ? 'bi-chevron-left' : 'bi-chevron-right'"></i>
    </button>

      <!-- INDICE -->
      <div *ngIf="showSidebar" class="col-md-5 sidebar-content">
        <div class="sticky-sidebar">
          <app-index
            [sections]="indexSections"
            (sectionSelected)="scrollToSection($event)">
          </app-index>
        </div>
      </div>

      <div class="col">

        <!-- HISTORIA CLNICA -->
        <div *ngIf="patient && !isLoading" >

          <!--(Contenido H.C.)-->
          <div>


              <!-- Patient Name and Basic Info -->
              <div class="patient-header">
                <div class="row align-items-center">
                  <div class="col-md-8">
                    <!-- hasta que se pueda obtener apellidos -->
                    <h2 class="patient-name mb-1">{{ patient.nombre }} <!--{{ formatValue(patient.apellidoPaterno) }} {{ formatValue(patient.apellidoMaterno) }}--></h2>
                    <p class="patient-dni text-muted mb-0">DNI: {{ patient.dni }}</p>
                  </div>
                  <div class="col-md-4 text-end">
                    <div class="hospital-info">
                      <div class="fw-bold">Hospitalizaci贸n</div>
                      <div class="text-primary fw-bold">Cama: {{ formatValue(patient.cama) }}</div>
                    </div>
                    <div class="hospital-logo mt-2">
                      <div class="hospital-name">
                        <div class="fw-bold">Hospital Regional III</div>
                        Honorio Delgado
                      </div>
                      <img src="assets/logo.png" alt="Hospital Logo" class="logo-small">
                    </div>
                  </div>
                </div>
              </div>


              <!-- Filiaci贸n -->
              <div id="datos-afiliacion" class="card mt-4">
                <div class="card-header">
                  <h3 class="mb-0">DATOS DE AFILIACIN</h3>
                </div>
                <div class="card-body">
                  <!-- Row 1 -->
                  <div class="row mb-3">
                    <div class="col-md-3">
                      <label class="form-label text-muted">Nombre:</label>
                      <div class="form-control-plaintext">{{ patient.nombre }}</div>
                    </div>
                    <div class="col-md-3">
                      <label class="form-label text-muted">DNI:</label>
                      <div class="form-control-plaintext">{{ patient.dni }}</div>
                    </div>
                    <div class="col-md-3">
                      <label class="form-label text-muted">Sexo:</label>
                      <div class="form-control-plaintext text-capitalize">{{ patient.sexo }}</div>
                    </div>
                    <div class="col-md-3">
                      <label class="form-label text-muted">Edad:</label>
                      <div class="form-control-plaintext">{{ patient.edad }}</div>
                    </div>
                  </div>

                  <!-- Row 2 -->
                  <div class="row mb-3">
                    <div class="col-md-3">
                      <label class="form-label text-muted">Ap. Paterno:</label>
                      <div class="form-control-plaintext">{{ formatValue(patient.apellidoPaterno) }}</div>
                    </div>
                    <div class="col-md-3">
                      <label class="form-label text-muted">Ap. Materno:</label>
                      <div class="form-control-plaintext">{{ formatValue(patient.apellidoMaterno) }}</div>
                    </div>
                    <div class="col-md-3">
                      <label class="form-label text-muted">Religi贸n:</label>
                      <div class="form-control-plaintext text-capitalize">{{ formatValue(patient.religion) }}</div>
                    </div>
                    <div class="col-md-3">
                      <label class="form-label text-muted">Grupo sangu铆neo:</label>
                      <div class="form-control-plaintext">{{ formatValue(patient.grupoSanguineo) }}</div>
                    </div>
                  </div>

                  <!-- Row 3 -->
                  <div class="row mb-3">
                    <div class="col-md-3">
                      <label class="form-label text-muted">Fec. Nac.:</label>
                      <div class="form-control-plaintext">{{ formatDate(patient.fecNac) }}</div>
                    </div>
                    <div class="col-md-3">
                      <label class="form-label text-muted">Factor RH:</label>
                      <div class="form-control-plaintext">{{ formatValue(patient.factorRH) }}</div>
                    </div>
                    <div class="col-md-3">
                      <label class="form-label text-muted">Ocupaci贸n:</label>
                      <div class="form-control-plaintext text-capitalize">{{ formatValue(patient.ocupacion) }}</div>
                    </div>
                    <div class="col-md-3">
                      <label class="form-label text-muted">Familiar encargado:</label>
                      <div class="form-control-plaintext">{{ formatValue(patient.familiarEncargado) }}</div>
                    </div>
                  </div>

                  <!-- Row 4 -->
                  <div class="row mb-3">
                    <div class="col-md-3">
                      <label class="form-label text-muted">Lugar Nac.:</label>
                      <div class="form-control-plaintext">{{ formatValue(patient.lugarNac) }}</div>
                    </div>
                    <div class="col-md-3">
                      <label class="form-label text-muted">Est. Civil:</label>
                      <div class="form-control-plaintext text-capitalize">{{ formatValue(patient.estCivil) }}</div>
                    </div>
                    <div class="col-md-6">
                      <label class="form-label text-muted">Direcci贸n:</label>
                      <div class="form-control-plaintext">{{ formatValue(patient.direccion) }}</div>
                    </div>
                  </div>

                  <!-- Row 5 -->
                  <div class="row">
                    <div class="col-md-3">
                      <label class="form-label text-muted">Grado Inst.:</label>
                      <div class="form-control-plaintext text-capitalize">{{ formatValue(patient.gradoInst) }}</div>
                    </div>
                  </div>
                </div>
              </div>
              
              <!-- History Section -->
              <div id="historia-enfermedad" class="card mt-4">
                <div class="card-header">
                  <h3 class="mb-0">Historia de la Enfermedad</h3>
                </div>
                <div class="card-body">
                  <div class="row mb-3">
                    <div class="col-md-6">
                      <label class="form-label text-muted">Fecha ingreso</label>
                      <div class="row">
                        <div class="col-6">
                          <label class="form-label small">Desde:</label>
                          <div class="form-control-plaintext">{{ patient?.historiaEnfermedad?.fechaIngreso || formatDate(patient?.fecNac || '') }}</div>
                        </div>
                        <div class="col-6">
                          <label class="form-label small">Hasta:</label>
                          <div class="form-control-plaintext">{{ patient?.historiaEnfermedad?.fechaHasta || '30/05/2025' }}</div>
                        </div>
                      </div>
                    </div>
                    <div class="col-md-2">
                      <label class="form-label text-muted">Tiempo de enfermedad:</label>
                      <div class="form-control-plaintext">{{ patient?.historiaEnfermedad?.tiempoEnfermedad || '11 a帽os' }}</div>
                    </div>
                    <div class="col-md-2">
                      <label class="form-label text-muted">Forma de inicio:</label>
                      <div class="form-control-plaintext">{{ patient?.historiaEnfermedad?.formaInicio || 'Insidioso' }}</div>
                    </div>
                    <div class="col-md-2">
                      <label class="form-label text-muted">Curso:</label>
                      <div class="form-control-plaintext">{{ patient?.historiaEnfermedad?.curso || 'Progresivo' }}</div>
                    </div>
                  </div>
                  
                  <div class="row">
                    <div class="col-12">
                      <label class="form-label text-muted">S铆ntomas y signos principales:</label>
                      <div class="form-control-plaintext border p-3">
                        {{ patient?.historiaEnfermedad?.sintomas || 'Consumo excesivo de sustancias psicoactivas, impulsividad' }}
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Anamnesis -->
              <div id="anamnesis" class="card mt-4">
                <div class="card-header">
                  <h3 class="mb-0">ANAMNESIS</h3>
                </div>
                <div class="card-body">
                  <div class="anamnesis-content">
                    {{ patient?.anamnesis || 'Familiares refieren que paciente empieza el consumo de bebidas alcoh贸licas al terminar la secundaria, lo hace de manera eventual, al terminar el colegio contin煤a con el consumo de bebidas alcoh贸licas, en algunas ocasiones se iba a las clases del instituto. Consumo se va intensificando con el tiempo, se realiza cortes en el antebrazo durante la adolescencia...' }}
                  </div>
                </div>
              </div>

              <!-- Funciones Biol贸gicas -->
              <div id="funciones-biologicas" class="card mt-4">
                <div class="card-header">
                  <h3 class="mb-0">Funciones Biol贸gicas</h3>
                </div>
                <div class="card-body">
                  <div class="row">
                    <div class="col-md-2">
                      <label class="form-label text-muted">Apetito</label>
                      <div class="form-control-plaintext">{{ patient?.funcionesBiologicas?.apetito || 'Conservado' }}</div>
                    </div>
                    <div class="col-md-2">
                      <label class="form-label text-muted">Sed</label>
                      <div class="form-control-plaintext">{{ patient?.funcionesBiologicas?.sed || 'Conservado' }}</div>
                    </div>
                    <div class="col-md-2">
                      <label class="form-label text-muted">Sue帽o</label>
                      <div class="form-control-plaintext">{{ patient?.funcionesBiologicas?.sueno || 'Aumentado' }}</div>
                    </div>
                    <div class="col-md-2">
                      <label class="form-label text-muted">Deposici贸n</label>
                      <div class="form-control-plaintext">{{ patient?.funcionesBiologicas?.deposicion || 'Conservado' }}</div>
                    </div>
                    <div class="col-md-2">
                      <label class="form-label text-muted">Micci贸n</label>
                      <div class="form-control-plaintext">{{ patient?.funcionesBiologicas?.miccion || 'Conservado' }}</div>
                    </div>
                    <div class="col-md-2">
                      <label class="form-label text-muted">Deseo Sexual</label>
                      <div class="form-control-plaintext">{{ patient?.funcionesBiologicas?.deseoSexual || 'Conservado' }}</div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Antecedentes -->
              <div id="antecedentes" class="card mt-4">
                <div class="card-header">
                  <h3 class="mb-0">ANTECEDENTES</h3>
                </div>
                <div class="card-body">
                  <!-- Personales -->
                  <div id="a_personales" class="mb-4">
                    <h5 class="section-subtitle">Personales</h5>
                    <div class="antecedentes-content border p-3">
                      {{ patient?.antecedentes?.personales || 'PERINATALES, PRENATALES Y POSTNATALES: parto normal a los 9 meses, controles prenatales aparentemente completos, intranquilizarlo, no precisa m谩s datos...' }}
                    </div>
                  </div>

                  <!-- Historia Acad茅mica -->
                  <div id="a_academicos" class="mb-4">
                    <h5 class="section-subtitle">HISTORIA ACADMICA</h5>
                    <div class="antecedentes-content border p-3">
                      {{ patient?.antecedentes?.historiaAcademica || 'Jard铆n y primaria: buen desenvolvimiento acad茅mico, le gustaba estudiar, no tuvo problemas con sus compa帽eros y docentes, curs贸 satisfactoriamente sus estudios...' }}
                    </div>
                  </div>

                  <!-- Judiciales -->
                  <div id="a_judiciales" class="mb-4">
                    <h5 class="section-subtitle">Judiciales</h5>
                    <div class="form-control-plaintext border p-3">
                      {{ patient?.antecedentes?.judiciales || 'Niega' }}
                    </div>
                  </div>

                  <!-- Patol贸gicos -->
                  <div id="a_patologicos" class="mb-4">
                    <h5 class="section-subtitle">Patol贸gicos</h5>
                    <div class="row mb-2">
                      <div class="col-md-3">
                        <label class="form-label text-muted small">Enfermedades Cr贸nicas</label>
                        <div class="form-control-plaintext">Niega</div>
                      </div>
                      <div class="col-md-3">
                        <label class="form-label text-muted small">Transfusiones</label>
                        <div class="form-control-plaintext">Niega</div>
                      </div>
                      <div class="col-md-3">
                        <label class="form-label text-muted small">Enfermedades Neurol贸gicas</label>
                        <div class="form-control-plaintext">Niega</div>
                      </div>
                      <div class="col-md-3">
                        <label class="form-label text-muted small">RAM</label>
                        <div class="form-control-plaintext">Niega</div>
                      </div>
                    </div>
                  </div>

                  <!-- Familiares -->
                  <div id="a_familiares" class="mb-4">
                    <h5 class="section-subtitle">Familiares</h5>
                    <div class="row mb-3">
                      <div class="col-md-4">
                        <label class="form-label text-muted">Estado Padre</label>
                        <div class="form-control-plaintext">Vivo aparentemente sano</div>
                      </div>
                      <div class="col-md-4">
                        <label class="form-label text-muted">Hermanos</label>
                        <div class="form-control-plaintext">no refiere</div>
                      </div>
                      <div class="col-md-4">
                        <label class="form-label text-muted">Estado Madre</label>
                        <div class="form-control-plaintext">Vivo aparentemente sano</div>
                      </div>
                    </div>
                    
                    <div class="mb-3">
                      <label class="form-label text-muted">PERSONALIDAD PREVIA</label>
                      <div class="antecedentes-content border p-3">
                        {{ patient?.antecedentes?.personalidadPrevia || 'Ni帽ez: Alegre, se relacionaba con aparente normalidad; Adolescencia: Se relacionaba con aparente normalidad por momentos impulsivos...' }}
                      </div>
                    </div>
                  </div>

                  <!-- Socioecon贸micos -->
                  <div id="a_socioeconomicos" class="mb-4">
                    <h5 class="section-subtitle">Socioecon贸micos</h5>
                    <div class="row mb-2">
                      <div class="col-md-6">
                        <label class="form-label text-muted">Vivienda</label>
                        <div class="form-control-plaintext">Propia, de material noble</div>
                      </div>
                      <div class="col-md-6">
                        <label class="form-label text-muted">Agua y saneamiento</label>
                        <div class="form-control-plaintext">Cuenta con servicios b谩sicos</div>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-12">
                        <label class="form-label text-muted">Sustento econ贸mico</label>
                        <div class="form-control-plaintext">Actualmente depende econ贸micamente de familiares</div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Examen F铆sico -->
              <div id="examen-fisico" class="card mt-4">
                <div class="card-header">
                  <h3 class="mb-0">Examen F铆sico</h3>
                </div>
                <div class="card-body">
                  <!-- Funciones Vitales -->
                  <div class="mb-4">
                    <h5 class="section-subtitle">FUNCIONES VITALES</h5>
                    <div class="row">
                      <div class="col-md-2">
                        <label class="form-label text-muted small">P/A</label>
                        <div class="form-control-plaintext">110/70 mmHg</div>
                      </div>
                      <div class="col-md-2">
                        <label class="form-label text-muted small">F.C</label>
                        <div class="form-control-plaintext">83/min</div>
                      </div>
                      <div class="col-md-2">
                        <label class="form-label text-muted small">F.R</label>
                        <div class="form-control-plaintext">18 RPM</div>
                      </div>
                      <div class="col-md-2">
                        <label class="form-label text-muted small">SatO2</label>
                        <div class="form-control-plaintext">110/70 mmHg</div>
                      </div>
                      <div class="col-md-2">
                        <label class="form-label text-muted small">T掳</label>
                        <div class="form-control-plaintext">36.5</div>
                      </div>
                    </div>
                  </div>

                  <!-- Examen General -->
                  <div class="mb-4">
                    <h5 class="section-subtitle">Examen General</h5>
                    <div class="row mb-2">
                      <div class="col-md-2">
                        <label class="form-label text-muted small">Peso</label>
                        <div class="form-control-plaintext">86.7 kg</div>
                      </div>
                      <div class="col-md-2">
                        <label class="form-label text-muted small">Talla</label>
                        <div class="form-control-plaintext">1.58 cm</div>
                      </div>
                      <div class="col-md-2">
                        <label class="form-label text-muted small">IMC</label>
                        <div class="form-control-plaintext">22.7</div>
                      </div>
                    </div>
                    
                    <div class="antecedentes-content border p-3">
                      {{ patient?.examenFisico?.examenGeneral || 'PACIENTE EN REG, BEH, BIEN ventilaci贸n espont谩nea. Piel tibia, turgencia y elasticidad conservada. TCSC conservado en cantidad, limitado: cepillo = 2 segundos, pelo negro en regular cantidad...' }}
                    </div>
                  </div>
                </div>
              </div>

              <!-- Evoluci贸n -->
              <div id="evolucion" class="card mt-4">
                <div class="card-header">
                  <h3 class="mb-0">EVOLUCIN</h3>
                </div>
                <div class="card-body">
                  <div *ngFor="let evolucion of patient?.evolucion || getDefaultEvolucion()" class="evolucion-item mb-4">
                    <div class="d-flex justify-content-between align-items-center mb-2">
                      <h6 class="evolucion-title">{{ evolucion.titulo }}</h6>
                      <button class="btn btn-sm btn-outline-primary">
                        <i class="bi bi-plus-circle"></i>
                      </button>
                    </div>
                    <div class="evolucion-content border p-3">
                      {{ evolucion.contenido }}
                    </div>
                  </div>
                </div>
              </div>

>>>>>>> origin/edurando
          </div>

        </div>

        <!-- DOCUMENTO 1 -->
        <div id="documento-1" class="mt-5">
          <h4 class="mb-3"> Documento 1</h4>
          <p>Contenido de muestra para documento 1.</p>
        </div>
      </div>

  </div>





</div>
